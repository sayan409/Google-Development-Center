<template>
	<lightning-card title="Product Entry Form">
		<div>
			<template for:each={rows} for:item="row">
				<div key={row.id} class="slds-grid slds-gutters slds-p-around_medium">
					<div class="slds-col slds-size_1-of-4">
						<lightning-input label="Product" value={row.product} data-id={row.id} data-field="product"
							onchange={handleProductChange} onkeyup={handleProductSearch}></lightning-input>
                           <template if:true={row.productSuggestions.length}>
                            <div class="slds-box slds-m-top_xx-small">
                                <template for:each={row.productSuggestions} for:item="suggestion">
                                    <div key={suggestion.Id} data-id={row.id} data-field="product" data-value={suggestion.Name} onclick={selectProduct}>
                                        {suggestion.Name}
                                    </div>
                                </template>
                            </div>
                        </template>
					</div>
					<div class="slds-col slds-size_1-of-4">
						<lightning-input label="Quantity" type="number" value={row.quantity} data-id={row.id}
							data-field="quantity" onchange={handleInputChange}></lightning-input>
					</div>
					<div class="slds-col slds-size_1-of-4">
						<lightning-input label="Unit Price" type="number" value={row.unitPrice} data-id={row.id}
							data-field="unitPrice" onchange={handleInputChange}></lightning-input>
					</div>
					<div class="slds-col slds-size_1-of-4">
						<lightning-combobox label="Priority" value={row.priority} data-id={row.id} data-field="priority"
							onchange={handleInputChange} options={priorityOptions}></lightning-combobox>
					</div>

				</div>
			</template>
		</div>
		<div class="slds-clearfix">
			<div class="slds-m-top_medium slds-p-around_medium">
				<lightning-button label="+Add Row" onclick={addRow}></lightning-button>
			</div>

			<div class="slds-m-top_medium slds-p-around_medium slds-float_right">
				<lightning-button label="Submit" onclick={handleSubmit}></lightning-button>
			</div>
		</div>
	</lightning-card>
</template>